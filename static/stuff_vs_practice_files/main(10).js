AUI.add("liferay-bbcode-editor",function(b){var a=function(d){var c=this;d=d||{};c._textarea=b.one(d.textarea);c._location=b.one(d.location);c._createEmoticons(function(){c._createToolbar();if(d.onLoad){d.onLoad()}})};a.prototype={getHTML:function(d){var c=this;return c._textarea.val()},insertTag:function(q,e,k){var p=this;var i;if(e){i="["+q+"="+e+"]"}else{i="["+q+"]"}var g="[/"+q+"]";var o=p._textarea;var m=o.getDOM();var n=o.val();if(Liferay.Browser.isIe()){p._setSelectionRange();if(k!=null){p._selectionRange.text=i+k+g}else{p._selectionRange.text=i+p._selectionRange.text+g}p._selectionRange.moveEnd("character",-g.length);p._selectionRange.select();p._selectionRange=null}else{if(m.selectionStart||m.selectionStart==0){var j=m.selectionStart;var c=m.selectionEnd;var f=n.substring(0,j);var d=n.substring(j,c);var l=n.substring(c,m.value.length);var h=j+i.length;if(k!=null){m.value=f+i+k+g+l}else{m.value=f+i+d+g+l;m.setSelectionRange(h,h)}}else{m.value+=i+k+g}}o.focus()},setHTML:function(d){var c=this;c._textarea.val(d)},_createEmoticons:function(d){var c=this;b.io.request(themeDisplay.getPathMain()+"/portal/emoticons",{on:{success:function(h,j,i){var g=this.get("responseData");var e=b.Node.create('<div class="lfr-emoticon-container"></div>');c._emoticons=e.html(g);var f=c._emoticons.all(".emoticon");if(f){f.on("click",function(l){var k=l.currentTarget.getAttribute("emoticonCode");if(k){c._insertEmoticon(k)}})}if(d){d.apply(c,[])}}}})},_createToolbar:function(){var l=this;var h="";l._buttons={fontType:{onChange:function(m){var o=m.target;var n=o.val();if(n!='\u0046\u006f\u006e\u0074'){l.insertTag("font",n);o.set("selectedIndex",0)}},options:['\u0046\u006f\u006e\u0074',"Arial","Comic Sans","Courier New","Tahoma","Times New Roman","Verdana","Wingdings"]},fontSize:{groupEnd:true,onChange:function(m){var o=m.target;var n=o.val();if(n!='\u0053\u0069\u007a\u0065'){l.insertTag("size",n);o.set("selectedIndex",0)}},options:['\u0053\u0069\u007a\u0065',1,2,3,4,5,6,7]},b:{image:"message_boards/bold.png",onClick:function(m){l.insertTag("b")},text:'\u0042\u006f\u006c\u0064'},i:{image:"message_boards/italic.png",onClick:function(m){l.insertTag("i")},text:'\u0049\u0074\u0061\u006c\u0069\u0063'},u:{image:"message_boards/underline.png",onClick:function(m){l.insertTag("u")},text:'\u0055\u006e\u0064\u0065\u0072\u006c\u0069\u006e\u0065'},s:{image:"message_boards/strike.png",onClick:function(m){l.insertTag("s")},text:'\u0053\u0074\u0072\u0069\u006b\u0065\u0074\u0068\u0072\u006f\u0075\u0067\u0068'},fontColor:{className:"use-colorpicker",groupEnd:true,image:"message_boards/color.png",text:'\u0046\u006f\u006e\u0074\u0020\u0043\u006f\u006c\u006f\u0072'},url:{image:"message_boards/hyperlink.png",onClick:function(m){l._insertURL()},text:'\u0055\u0052\u004c'},email:{image:"message_boards/email.png",onClick:function(m){l._insertEmail()},text:'\u0045\u006d\u0061\u0069\u006c\u0020\u0041\u0064\u0064\u0072\u0065\u0073\u0073'},image:{image:"message_boards/image.png",onClick:function(m){l._insertImage()},text:'\u0049\u006d\u0061\u0067\u0065'},ol:{image:"message_boards/ordered_list.png",onClick:function(m){l._insertList("1")},text:'\u004f\u0072\u0064\u0065\u0072\u0065\u0064\u0020\u004c\u0069\u0073\u0074'},ul:{image:"message_boards/unordered_list.png",onClick:function(m){l._insertList("")},text:'\u0055\u006e\u006f\u0072\u0064\u0065\u0072\u0065\u0064\u0020\u004c\u0069\u0073\u0074'},left:{image:"message_boards/justify_left.png",onClick:function(m){l.insertTag("left")},text:'\u004c\u0065\u0066\u0074'},center:{image:"message_boards/justify_center.png",onClick:function(m){l.insertTag("center")},text:'\u0043\u0065\u006e\u0074\u0065\u0072'},right:{image:"message_boards/justify_right.png",onClick:function(m){l.insertTag("right")},text:'\u0052\u0069\u0067\u0068\u0074'},indent:{text:'\u0049\u006e\u0064\u0065\u006e\u0074',image:"message_boards/indent.png",onClick:function(m){l.insertTag("indent")}},quote:{image:"message_boards/quote.png",onClick:function(m){l.insertTag("quote")},text:'\u0051\u0075\u006f\u0074\u0065'},code:{image:"message_boards/code.png",onClick:function(m){l.insertTag("code")},text:'\u0043\u006f\u0064\u0065'},emoticons:{image:"emoticons/smile.gif",text:'\u0045\u006d\u006f\u0074\u0069\u0063\u006f\u006e\u0073'}};b.each(l._buttons,function(r,p){var o=" "+(r.className||"");var q=r.text||"";if(p!="insert"&&!r.options){var m=themeDisplay.getPathThemeImages()+"/"+r.image;h+='<a buttonId="'+p+'" class="lfr-button '+o+'" href="javascript:;" title="'+q+'"><img alt="'+q+'" buttonId="'+p+'" src="'+m+'" ></a>'}else{if(r.options&&r.options.length){h+='<select class="'+o+'" selectId="'+p+'" title="'+q+'">';b.each(r.options,function(n,s){h+='<option value="'+n+'">'+n+"</option>"});h+="</select>"}}if(r.groupEnd){h+='<span class="lfr-separator"></span>'}});if(!l._location){l._location=b.Node.create('<div class="lfr-toolbar">'+h+"</div>");l._textarea.placeBefore(l._location)}else{l._location.html(h)}var f=l._location.all(".lfr-button[buttonId=emoticons]");var e=false;var d=0;var i=0;var g=0;var c=new b.OverlayContext({align:{points:["tr","br"]},contentBox:l._emoticons,hideDelay:500,trigger:f.item(0)});c.render();l._location.on("click",function(n){l._setSelectionRange();var o=n.target;var m=n.target.getAttribute("buttonId");if(m&&l._buttons[m].onClick){l._buttons[m].onClick.apply(o,[n])}});var j=l._location.all("select");if(j){j.on("change",function(n){var m=n.target.getAttribute("selectId");if(m&&l._buttons[m].onChange){l._buttons[m].onChange.apply(this,[n])}})}l._fontColorInput=b.Node.create('<input type="hidden" val="" />');var k=l._location.one(".use-colorpicker");var k=l._location.one(".use-colorpicker");if(k){l._fontColorInput.placeBefore(k);new b.ColorPicker({after:{colorChange:function(){l._fontColorInput.val("#"+this.get("hex"))},visibleChange:function(m){if(!m.newVal){l._insertColor()}}},trigger:k,zIndex:9999}).render()}},_insertColor:function(){var c=this;var d=c._fontColorInput.val();c.insertTag("color",d)},_insertEmail:function(){var c=this;var e=prompt('\u0045\u006e\u0074\u0065\u0072\u0020\u0061\u006e\u0020\u0065\u006d\u0061\u0069\u006c\u0020\u0061\u0064\u0064\u0072\u0065\u0073\u0073\u002e',"");if(e){var d=prompt('\u0045\u006e\u0074\u0065\u0072\u0020\u0061\u0020\u006e\u0061\u006d\u0065\u0020\u0066\u006f\u0072\u0020\u0074\u0068\u0065\u0020\u0065\u006d\u0061\u0069\u006c\u0020\u0061\u0064\u0064\u0072\u0065\u0073\u0073\u002e',"");c._resetSelection();if(!d){d=e;e=null}c.insertTag("email",e,d)}},_getSelection:function(){var c=this;var d=c._textarea;var g=d.getDOM();var f=d.val();var e;if(Liferay.Browser.isIe()){c._setSelectionRange();e=c._selectionRange.text}else{if(g.selectionStart||g.selectionStart==0){e=f.substring(g.selectionStart,g.selectionEnd)}}return e},_insertEmoticon:function(h){var k=this;var j=k._textarea;var i=j.getDOM();j.focus();if(Liferay.Browser.isIe()){i.focus();var d=document.selection.createRange();d.text=h}else{if(i.selectionStart||i.selectionStart=="0"){var f=i.selectionStart;var c=i.selectionEnd;var e=i.value.substring(0,f);var g=i.value.substring(c,i.value.length);i.value=e+h+g}else{i.value+=h}}},_insertImage:function(){var c=this;var d=prompt('\u0045\u006e\u0074\u0065\u0072\u0020\u0061\u006e\u0020\u0061\u0064\u0064\u0072\u0065\u0073\u0073\u0020\u0066\u006f\u0072\u0020\u0074\u0068\u0065\u0020\u0069\u006d\u0061\u0067\u0065\u002e',"http://");if(d){c._resetSelection();c.insertTag("img",null,d)}},_insertList:function(d){var c=this;var f="\n";var e;while(e=prompt('\u0045\u006e\u0074\u0065\u0072\u0020\u0061\u0020\u006c\u0069\u0073\u0074\u0020\u0069\u0074\u0065\u006d\u002e\u0020\u0043\u006c\u0069\u0063\u006b\u0020\u003c\u0065\u006d\u003e\u0043\u0061\u006e\u0063\u0065\u006c\u003c\u002f\u0065\u006d\u003e\u0020\u006f\u0072\u0020\u006c\u0065\u0061\u0076\u0065\u0020\u0069\u0074\u0020\u0062\u006c\u0061\u006e\u006b\u0020\u0074\u006f\u0020\u0065\u006e\u0064\u0020\u0074\u0068\u0065\u0020\u006c\u0069\u0073\u0074\u002e',"")){if(!e){break}f+="[*]"+e+"\n"}if(f!="\n"){c._resetSelection();c.insertTag("list",d,f)}},_insertURL:function(){var c=this;var d=prompt('\u0045\u006e\u0074\u0065\u0072\u0020\u0061\u006e\u0020\u0061\u0064\u0064\u0072\u0065\u0073\u0073\u002e',"http://");if(d!=null){var f;var e=c._getSelection();if(e){f=e}else{f=prompt('\u0045\u006e\u0074\u0065\u0072\u0020\u0061\u0020\u0074\u0069\u0074\u006c\u0065\u0020\u0066\u006f\u0072\u0020\u0074\u0068\u0065\u0020\u0061\u0064\u0064\u0072\u0065\u0073\u0073\u002e',"")}if(f){c.insertTag("url",d,f)}else{c.insertTag("url",d)}}},_resetSelection:function(){var c=this;var d=c._textarea;var g=d.getDOM();if(Liferay.Browser.isIe()){g.focus();var e=document.selection.createRange();e.collapse(false);e.select()}else{if(g.setSelectionRange){var f=g.selectionStart;g.setSelectionRange(f,f)}}},_setSelectionRange:function(){var c=this;if(Liferay.Browser.isIe()&&(c._selectionRange==null)){c._textarea.focus();c._selectionRange=document.selection.createRange()}}};Liferay.namespace("Editor");Liferay.Editor.bbCode=a},"",{requires:["aui-color-picker-deprecated","aui-io-request","aui-overlay-context-deprecated"]});